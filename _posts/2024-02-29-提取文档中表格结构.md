---
layout:       post
title:        "提取文档中表格结构"
author:       "mjTree"
header-style: text
catalog:      true
tags:
    - document-parse
---

><small>更新于：2024-03-10 16:20</small>


### 一、简介
在前面的[文章](/2024/02/03/基于算法的通用文档解析实现)当中，介绍了一些深度学习算法的模型，通过模型对文档对进行版面元素识别分类。对于文档中的一些元素（页眉、页脚、标题、段落、图片、脚注等）只需要模型的区域即可，但是`Table`元素无法只能依靠一个区域就能解决的，我们需要获取表格中的线条信息来构建完整的表格结构。  


### 二、表格类型介绍

表格的基本组成单位是单元格，表格的基本组成元素则是线条。线条的则是有线型、颜色、宽度、底纹等的相互组合形成线条，进而能构建成各式各样的表格样式给用户展示其信息。但这就会使得表格的线条信息不稳定，对于提取线条工作存在很大的阻碍。目前业内通过线条的样式将表格的线条侧重的分两类，分别是缺线表格、全线表格（满线表格）。  

<img src="/img/article-img/2024/03/0310_1.png" alt="ExtractTable1" width="18%" height="18%">  

```text
全线表格：常见的表格类型，线条结构完整；对于艺术、多线条的线型，只要线条不缺失都归纳到该类型。
缺线表格：不符合全线表格的表格则认为是缺线表格，其中无线表格是缺线表格的特殊样例。
```

虽然缺线表格甚至无线表格缺少线条信息，但是内部的单元格保持着一定间距信息，也是可以让模型能学习到的。  


### 三、协议信息提取表格结构

该方案就是针对不同文件格式，对其文件的的协议方法获取其线条信息，word 等文件可以使用`ooxml`协议，之间[文章](/2023/12/14/关于ooxml协议的opc)介绍过。pdf 可以借用`mupdf`等第三方工具获取线条信息，图片则是借用`opencv`对其二值化获取横竖线信息。  

这些都是都是常见等文件格式的处理方案，对于其他不常见的格式，直接解析方便可以直接处理，如果解析协议码成本大可以将其转换成上面的格式再处理，方案流程图如下。  

![ExtractTable2](/img/article-img/2024/03/0310_2.png)  


### 四、算法模型提取表格结构

#### 1、方案介绍
算法还是走的`CV`的方向，这个方案是比较常见。文件映射的图片信息放入模型中，识别得到表格区域以及线条信息，然后将线条构建出单元格（表格的基本组成单位），流程可以参考下图。  

![ExtractTable3](/img/article-img/2024/03/0310_3.png)  

#### 2、线条识别方案


### 四、小结


